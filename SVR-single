import numpy as np
from sklearn.decomposition import PCA
from sklearn import svm
import sys
import csv

#noteï¼šwe need a atr pattern file 'pattern.csv', a label file 'label.csv'.
#reading atr pattern
pattern=list()
fhd=csv.reader(open('pattern.csv','r'))
for line in fhd:
    pattern.append(line)

#reading label data
label=list()
fhl=csv.reader(open('label.csv','r'))
for line in fhl:
    label.append(line)
label=np.array(label,dtype='float64')
label=label.tolist()

#data preparation for SVR
raw_train=list()
label_train=list()
raw_test=list()
label_test=list()
i,j=1,1
for line in pattern:
    if i==4:
        raw_test.append(line)
        i=1
    else:
        raw_train.append(line)
        i=i+1
for line in label:
    if j==4:
        label_test.append(line)
        j=1
    else:
        label_train.append(line)
        j=j+1

#conducting SVR and writing to a new csv file
clf=svm.SVR(kernel='poly') #choosing kernel, e.g. linear, rbf, poly
clf.fit(raw_train,label_train)
label_predict=clf.predict(raw_test)
label_predict=label_predict.tolist()
output=csv.writer(open('label_predict.csv','a',newline=''),dialect='excel')
output.writerows(map(lambda x:[x],label_predict))
